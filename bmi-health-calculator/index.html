<!-- Calculator Section -->
<section class="calculator">

  <!-- Spinner (Initially Hidden) -->
  <div id="spinner"></div>

  <!-- Results Box (Initially Hidden) -->
  <div class="card calc-results" id="results" style="display:none;">
    <h2>Results</h2>
    <p id="bmiResult">Your BMI: </p>
    <p id="category">Health Category: </p>
    <p id="advice">Health Advice: </p>
  </div>

  <!-- Calculator Card -->
  <div class="card calc-inputs">
    
    <!-- Age -->
    <label for="age">Your Age (years):</label>
    <input type="number" id="age" class="input-field" min="0" placeholder="Enter your age" />

    <!-- Gender -->
    <label for="gender">Gender:</label>
    <select id="gender" class="input-field">
      <option value="" disabled selected>-- Select Gender --</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>

    <!-- Height -->
    <label for="heightInput">Height:</label>
    <div class="height-input" style="display: flex; align-items: center; gap: 10px;">
      <!-- Single cm input (shown by default) -->
      <input type="number" id="heightCm" class="input-field" min="0" placeholder="Enter height in cm" />

      <!-- Ft/In inputs (hidden by default) -->
      <div id="heightFtIn" style="display:none; gap:10px;">
        <input type="number" id="heightFt" class="input-field" min="0" placeholder="Feet" />
        <input type="number" id="heightIn" class="input-field" min="0" max="11" placeholder="Inches" />
      </div>

      <select id="heightUnit" class="input-field">
        <option value="cm">cm</option>
        <option value="ft">ft/in</option>
      </select>
    </div>

    <!-- Weight -->
    <label for="weightInput">Weight:</label>
    <div class="weight-input" style="display:flex; align-items:center; gap:10px;">
      <input type="number" id="weightInput" class="input-field" min="0" placeholder="Enter weight" />
      <select id="weightUnit" class="input-field">
        <option value="kg">kg</option>
        <option value="lbs">lbs</option>
      </select>
    </div>

    <button id="calculateBtn" class="calculate-btn" type="button">Calculate</button>
  </div>
</section>

<!-- Script to toggle ft/in inputs and calculate BMI -->
<script>
  const heightUnit = document.getElementById('heightUnit');
  const heightCm = document.getElementById('heightCm');
  const heightFtIn = document.getElementById('heightFtIn');
  const heightFt = document.getElementById('heightFt');
  const heightIn = document.getElementById('heightIn');
  const weightInput = document.getElementById('weightInput');
  const weightUnit = document.getElementById('weightUnit');
  const ageInput = document.getElementById('age');
  const genderInput = document.getElementById('gender');

  const bmiResult = document.getElementById('bmiResult');
  const category = document.getElementById('category');
  const advice = document.getElementById('advice');
  const resultsBox = document.getElementById('results');

  // Toggle height inputs
  heightUnit.addEventListener('change', () => {
    if(heightUnit.value === 'ft') {
      heightCm.style.display = 'none';
      heightFtIn.style.display = 'flex';
    } else {
      heightCm.style.display = 'block';
      heightFtIn.style.display = 'none';
    }
  });

  // BMI Calculation
  document.getElementById('calculateBtn').addEventListener('click', () => {
    let heightInCm;
    let weightInKg = parseFloat(weightInput.value);
    let age = parseInt(ageInput.value);

    // Validation
    if (isNaN(age) || age <= 0) { alert("Please enter a valid age."); return; }
    if (isNaN(weightInKg) || weightInKg <= 0) { alert("Please enter a valid weight."); return; }

    // Height conversion
    if (heightUnit.value === 'cm') {
      heightInCm = parseFloat(heightCm.value);
      if (isNaN(heightInCm) || heightInCm <= 0) { alert("Please enter a valid height in cm."); return; }
    } else {
      let ft = parseInt(heightFt.value);
      let inch = parseInt(heightIn.value);
      if (isNaN(ft) || ft < 0) { alert("Please enter valid feet."); return; }
      if (isNaN(inch) || inch < 0 || inch > 11) { alert("Please enter valid inches (0-11)."); return; }
      heightInCm = (ft * 30.48) + (inch * 2.54); // Convert to cm
    }

    // Weight conversion if in lbs
    if(weightUnit.value === 'lbs') {
      weightInKg = weightInKg * 0.453592;
    }

    // BMI calculation
    const heightInM = heightInCm / 100;
    const bmi = weightInKg / (heightInM * heightInM);
    let categoryText = "";
    let adviceText = "";

    if(bmi < 18.5){
      categoryText = "Underweight";
      adviceText = "Consider gaining weight through a balanced diet.";
    } else if(bmi < 24.9){
      categoryText = "Normal weight";
      adviceText = "Keep up your healthy lifestyle!";
    } else if(bmi < 29.9){
      categoryText = "Overweight";
      adviceText = "Consider regular exercise and a balanced diet.";
    } else {
      categoryText = "Obese";
      adviceText = "Consult a healthcare provider for advice.";
    }

    bmiResult.textContent = `Your BMI: ${bmi.toFixed(2)}`;
    category.textContent = `Health Category: ${categoryText}`;
    advice.textContent = `Health Advice: ${adviceText}`;
    resultsBox.style.display = 'block';
  });
</script>
